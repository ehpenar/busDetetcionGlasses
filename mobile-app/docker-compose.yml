#  Docker Compose para Bus Detection Mobile App
# Este archivo orquesta el contenedor y define la configuraci贸n

services:
  #  Servicio principal de la aplicaci贸n
  bus-detection-app:
    build:
      context: .
      dockerfile: Dockerfile
    
    #  Explicaci贸n: build define c贸mo construir la imagen
    # context: . significa usar el directorio actual como contexto
    # dockerfile: Dockerfile especifica qu茅 archivo usar
    
    container_name: bus-detection-mobile
    
    #  Explicaci贸n: container_name le da un nombre espec铆fico al contenedor
    # til para referenciarlo en otros comandos
    
    ports:
      - "19000:19000"  # Metro bundler
      - "19001:19001"  # Expo DevTools
      - "19002:19002"  # Expo DevTools alternativo
    
    #  Explicaci贸n: ports mapea puertos del contenedor al host
    # Formato: "puerto_host:puerto_contenedor"
    # Esto permite acceder a la app desde tu m谩quina
    
    volumes:
      - .:/app
      - /app/node_modules
    
    #  Explicaci贸n: volumes monta directorios del host en el contenedor
    # .:/app sincroniza tu c贸digo local con el contenedor
    # /app/node_modules evita conflictos con node_modules del host
    
    environment:
      - NODE_ENV=development
      - EXPO_DEVTOOLS_LISTEN_ADDRESS=0.0.0.0
    
    #  Explicaci贸n: environment define variables de entorno
    # NODE_ENV=development activa modo desarrollo
    # EXPO_DEVTOOLS_LISTEN_ADDRESS permite acceso externo a DevTools
    
    stdin_open: true
    tty: true
    
    #  Explicaci贸n: stdin_open y tty permiten interacci贸n con el contenedor
    # Necesario para que Expo funcione correctamente
    
    networks:
      - bus-detection-network
    
    #  Explicaci贸n: networks crea una red aislada para la aplicaci贸n
    # til si en el futuro agregamos m谩s servicios (base de datos, etc.)

  #  Servicio opcional para desarrollo (solo si necesitas herramientas adicionales)
  # Puedes descomentar si necesitas una base de datos o API
  # 
  # database:
  #   image: postgres:15-alpine
  #   container_name: bus-detection-db
  #   environment:
  #     POSTGRES_DB: bus_detection
  #     POSTGRES_USER: expo
  #     POSTGRES_PASSWORD: password
  #   volumes:
  #     - postgres_data:/var/lib/postgresql/data
  #   networks:
  #     - bus-detection-network

#  Definici贸n de redes
networks:
  bus-detection-network:
    driver: bridge
    
    #  Explicaci贸n: bridge es el driver de red por defecto
    # Permite comunicaci贸n entre contenedores en la misma red

#  Vol煤menes persistentes (para futuras bases de datos)
volumes:
  postgres_data:
    driver: local
    
    #  Explicaci贸n: Los vol煤menes persisten datos entre reinicios del contenedor
    # til para bases de datos, cach茅, etc.
